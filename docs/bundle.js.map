{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/main.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","window.onload = function () {\n\n  let mainInputVal = <HTMLInputElement>document.getElementById(\"main-input\");\n  let itemCount = 0;\n  let ol = document.querySelector(\".item-list\");\n\n  interface Itemp {\n    todo: String;\n    check: Boolean;\n  }  \n\n  let arrItems: Array<Itemp> = [];\n\n  if (localStorage.getItem(\"todo\") !== undefined) {\n    arrItems = JSON.parse(localStorage.getItem(\"todo\")) || [];\n    outItems();\n  }\n\n\n  document.getElementById(\"btn-ok\").onclick = function () {\n    if (mainInputVal.value === \"\") {\n      mainInputVal.style.borderColor = \"red\";\n      return;\n    }\n    mainInputVal.style.borderColor = \"\";\n    addTask(mainInputVal.value);\n    mainInputVal.value = \"\";\n    outItems();\n    initButtons();\n  }\n  mainInputVal.onkeydown = function (event) {\n    if (event.keyCode === 13) {\n      document.getElementById(\"btn-ok\").click();\n    }\n  }\n  // Добавляем информацию об айтеме в массив, массив отправляем в LocalStorage \n  function addTask(text: String) {\n    itemCount++;\n    var temp: Itemp = {\n      todo: text,\n      check: false\n    }\n    arrItems.push(temp);\n    localStorage.setItem(\"todo\", JSON.stringify(arrItems));\n  }\n  // Вывод/обновление списка айтемов\n  function outItems() {\n    let fragment = document.createDocumentFragment();\n    let i = 0;\n    // Формирование и заполнение айтема\n    for (let key in arrItems) {\n      let checked: String = \"\";\n      if (arrItems[key].check) {\n        checked = \" checked='checked'\";\n      } else {\n        checked = \"\";\n      }\n      i++;\n      let itemList = document.createElement(\"li\");\n      itemList.classList.add(\"item\");\n      itemList.innerHTML =\n        `<input type=\"checkbox\" id=\"item-${i}\" ${checked}>\n        <label for=\"item-${i}\">${arrItems[key].todo}</label>\n        <button id=\"btn-save\"></button>\n        <div class=\"buttons\">\n          <button id=\"btn-delete\"></button>\n          <button id=\"btn-edit\"></button>\n        </div>`;\n      fragment.appendChild(itemList);\n    }\n    ol.innerHTML = '';\n    ol.appendChild(fragment);\n    initButtons();\n    checkCondition();\n  }\n  // Инициализация обработчиков кнопок существующих айтемов\n  function initButtons() {\n    let items = document.querySelectorAll(\"li.item\");\n    for (let i = 0; i < items.length; i++) {\n      (items[i].querySelector(\"#btn-delete\") as HTMLElement).onclick = deleteItem;\n      (items[i].querySelector(\"#btn-edit\") as HTMLElement).onclick = editItem;\n    }\n\n    function deleteItem() {\n      this.parentElement.parentElement.remove();\n      let thisInputNumber = this.parentElement.parentElement.querySelector(\"input\").id.slice(-1);\n\n      deleteFromArr(arrItems, Number(thisInputNumber) - 1);\n      localStorage.setItem(\"todo\", JSON.stringify(arrItems));\n      outItems();\n\n      function deleteFromArr(arr: Array<Itemp>, number: number) {\n        return arr.splice(number, 1)\n      }\n    }\n\n    function editItem() {\n      let input = this.parentElement.parentElement.querySelector(\"input\");\n      let thisInputNumber = input.id.slice(-1);\n      let label = this.parentElement.parentElement.querySelector(\"label\");\n      let btnSave = this.parentElement.parentElement.querySelector(\"#btn-save\");\n      btnSave.style.display = \"inline\";\n      let btnRed = this;\n      btnRed.style.display = \"none\";\n\n      btnSave.onclick = function () {\n        if (!input.value) {\n          input.value = label.innerText;\n        }\n        label.innerText = input.value;\n        label.style.display = \"inline\"; \n        input.setAttribute(\"type\", \"checkbox\");\n        input.classList.remove(\"edit-input\");        \n        btnSave.style.display = \"none\";\n        btnRed.style.display = \"\";\n        changeItem(arrItems, Number(thisInputNumber) - 1, input.value);\n        localStorage.setItem(\"todo\", JSON.stringify(arrItems));\n      }\n      input.setAttribute(\"type\", \"text\");\n      input.classList.add(\"edit-input\");\n      label.style.display = \"none\";        \n      \n\n      function changeItem(arr: Array<Itemp>, number: number, str: String) {\n        return arr[number].todo = str;\n      }\n    }\n  }\n  // Инициализация проверки состояния айтема\n  function checkCondition() {\n    let itemsInList = document.querySelectorAll(\"li.item > input[type='checkbox']\");\n\n    for (let i = 0; i < itemsInList.length; i++) {\n      (itemsInList[i] as HTMLInputElement).onclick = function () {\n        let input = this;\n        let thisInputNumber = input.id.slice(-1);\n\n        if ((input as HTMLInputElement).type === \"text\") {\n          console.log(\"это текстовое поле\");\n          return false;\n        }\n\n        if (input.hasAttribute(\"checked\")) {\n          input.removeAttribute(\"checked\");\n          changeItemCheck(arrItems, Number(thisInputNumber) - 1, false);\n          localStorage.setItem(\"todo\", JSON.stringify(arrItems));\n        } else {\n          input.setAttribute(\"checked\", \"checked\");\n          changeItemCheck(arrItems, Number(thisInputNumber) - 1, true);\n          localStorage.setItem(\"todo\", JSON.stringify(arrItems));\n        }\n      }\n\n      function changeItemCheck(arr: Array<Itemp>, number: number, bool: Boolean) {\n        arr[number].check = bool;\n      }\n    }\n  }\n  // Инициализация кнопки очистки списка из LocalStorage\n  document.getElementById(\"btn-clear\").onclick = function () {\n    localStorage.clear();\n    ol.innerHTML = \"\";\n    itemCount = 0;\n    arrItems = [];\n  }\n\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLE1BQU0sQ0FBQyxNQUFNLEdBQUc7SUFFZCxJQUFJLFlBQVksR0FBcUIsUUFBUSxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUMzRSxJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUM7SUFDbEIsSUFBSSxFQUFFLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQU85QyxJQUFJLFFBQVEsR0FBaUIsRUFBRSxDQUFDO0lBRWhDLEVBQUUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQztRQUMvQyxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQzFELFFBQVEsRUFBRSxDQUFDO0lBQ2IsQ0FBQztJQUdELFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxHQUFHO1FBQzFDLEVBQUUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxLQUFLLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztZQUM5QixZQUFZLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDdkMsTUFBTSxDQUFDO1FBQ1QsQ0FBQztRQUNELFlBQVksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztRQUNwQyxPQUFPLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLFlBQVksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLFFBQVEsRUFBRSxDQUFDO1FBQ1gsV0FBVyxFQUFFLENBQUM7SUFDaEIsQ0FBQyxDQUFBO0lBQ0QsWUFBWSxDQUFDLFNBQVMsR0FBRyxVQUFVLEtBQUs7UUFD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QUFDO1FBQ2xCLFNBQVMsR0FBRyxDQUFDLENBQUM7UUFDZCxRQUFRLEdBQUcsRUFBRSxDQUFDO0lBQ2hCLENBQUMsQ0FBQTtBQUVILENBQUMsQ0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwid2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblxuICBsZXQgbWFpbklucHV0VmFsID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluLWlucHV0XCIpO1xuICBsZXQgaXRlbUNvdW50ID0gMDtcbiAgbGV0IG9sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pdGVtLWxpc3RcIik7XG5cbiAgaW50ZXJmYWNlIEl0ZW1wIHtcbiAgICB0b2RvOiBTdHJpbmc7XG4gICAgY2hlY2s6IEJvb2xlYW47XG4gIH0gIFxuXG4gIGxldCBhcnJJdGVtczogQXJyYXk8SXRlbXA+ID0gW107XG5cbiAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidG9kb1wiKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYXJySXRlbXMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidG9kb1wiKSkgfHwgW107XG4gICAgb3V0SXRlbXMoKTtcbiAgfVxuXG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tb2tcIikub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAobWFpbklucHV0VmFsLnZhbHVlID09PSBcIlwiKSB7XG4gICAgICBtYWluSW5wdXRWYWwuc3R5bGUuYm9yZGVyQ29sb3IgPSBcInJlZFwiO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBtYWluSW5wdXRWYWwuc3R5bGUuYm9yZGVyQ29sb3IgPSBcIlwiO1xuICAgIGFkZFRhc2sobWFpbklucHV0VmFsLnZhbHVlKTtcbiAgICBtYWluSW5wdXRWYWwudmFsdWUgPSBcIlwiO1xuICAgIG91dEl0ZW1zKCk7XG4gICAgaW5pdEJ1dHRvbnMoKTtcbiAgfVxuICBtYWluSW5wdXRWYWwub25rZXlkb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi1va1wiKS5jbGljaygpO1xuICAgIH1cbiAgfVxuICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L7QsSDQsNC50YLQtdC80LUg0LIg0LzQsNGB0YHQuNCyLCDQvNCw0YHRgdC40LIg0L7RgtC/0YDQsNCy0LvRj9C10Lwg0LIgTG9jYWxTdG9yYWdlIFxuICBmdW5jdGlvbiBhZGRUYXNrKHRleHQ6IFN0cmluZykge1xuICAgIGl0ZW1Db3VudCsrO1xuICAgIHZhciB0ZW1wOiBJdGVtcCA9IHtcbiAgICAgIHRvZG86IHRleHQsXG4gICAgICBjaGVjazogZmFsc2VcbiAgICB9XG4gICAgYXJySXRlbXMucHVzaCh0ZW1wKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRvZG9cIiwgSlNPTi5zdHJpbmdpZnkoYXJySXRlbXMpKTtcbiAgfVxuICAvLyDQktGL0LLQvtC0L9C+0LHQvdC+0LLQu9C10L3QuNC1INGB0L/QuNGB0LrQsCDQsNC50YLQtdC80L7QslxuICBmdW5jdGlvbiBvdXRJdGVtcygpIHtcbiAgICBsZXQgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgbGV0IGkgPSAwO1xuICAgIC8vINCk0L7RgNC80LjRgNC+0LLQsNC90LjQtSDQuCDQt9Cw0L/QvtC70L3QtdC90LjQtSDQsNC50YLQtdC80LBcbiAgICBmb3IgKGxldCBrZXkgaW4gYXJySXRlbXMpIHtcbiAgICAgIGxldCBjaGVja2VkOiBTdHJpbmcgPSBcIlwiO1xuICAgICAgaWYgKGFyckl0ZW1zW2tleV0uY2hlY2spIHtcbiAgICAgICAgY2hlY2tlZCA9IFwiIGNoZWNrZWQ9J2NoZWNrZWQnXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGVja2VkID0gXCJcIjtcbiAgICAgIH1cbiAgICAgIGkrKztcbiAgICAgIGxldCBpdGVtTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgICAgIGl0ZW1MaXN0LmNsYXNzTGlzdC5hZGQoXCJpdGVtXCIpO1xuICAgICAgaXRlbUxpc3QuaW5uZXJIVE1MID1cbiAgICAgICAgYDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cIml0ZW0tJHtpfVwiICR7Y2hlY2tlZH0+XG4gICAgICAgIDxsYWJlbCBmb3I9XCJpdGVtLSR7aX1cIj4ke2Fyckl0ZW1zW2tleV0udG9kb308L2xhYmVsPlxuICAgICAgICA8YnV0dG9uIGlkPVwiYnRuLXNhdmVcIj48L2J1dHRvbj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImJ1dHRvbnNcIj5cbiAgICAgICAgICA8YnV0dG9uIGlkPVwiYnRuLWRlbGV0ZVwiPjwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gaWQ9XCJidG4tZWRpdFwiPjwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5gO1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoaXRlbUxpc3QpO1xuICAgIH1cbiAgICBvbC5pbm5lckhUTUwgPSAnJztcbiAgICBvbC5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG4gICAgaW5pdEJ1dHRvbnMoKTtcbiAgICBjaGVja0NvbmRpdGlvbigpO1xuICB9XG4gIC8vINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC60L7QsiDQutC90L7Qv9C+0Log0YHRg9GJ0LXRgdGC0LLRg9GO0YnQuNGFINCw0LnRgtC10LzQvtCyXG4gIGZ1bmN0aW9uIGluaXRCdXR0b25zKCkge1xuICAgIGxldCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJsaS5pdGVtXCIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIChpdGVtc1tpXS5xdWVyeVNlbGVjdG9yKFwiI2J0bi1kZWxldGVcIikgYXMgSFRNTEVsZW1lbnQpLm9uY2xpY2sgPSBkZWxldGVJdGVtO1xuICAgICAgKGl0ZW1zW2ldLnF1ZXJ5U2VsZWN0b3IoXCIjYnRuLWVkaXRcIikgYXMgSFRNTEVsZW1lbnQpLm9uY2xpY2sgPSBlZGl0SXRlbTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWxldGVJdGVtKCkge1xuICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICBsZXQgdGhpc0lucHV0TnVtYmVyID0gdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0XCIpLmlkLnNsaWNlKC0xKTtcblxuICAgICAgZGVsZXRlRnJvbUFycihhcnJJdGVtcywgTnVtYmVyKHRoaXNJbnB1dE51bWJlcikgLSAxKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwidG9kb1wiLCBKU09OLnN0cmluZ2lmeShhcnJJdGVtcykpO1xuICAgICAgb3V0SXRlbXMoKTtcblxuICAgICAgZnVuY3Rpb24gZGVsZXRlRnJvbUFycihhcnI6IEFycmF5PEl0ZW1wPiwgbnVtYmVyOiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIGFyci5zcGxpY2UobnVtYmVyLCAxKVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVkaXRJdGVtKCkge1xuICAgICAgbGV0IGlucHV0ID0gdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0XCIpO1xuICAgICAgbGV0IHRoaXNJbnB1dE51bWJlciA9IGlucHV0LmlkLnNsaWNlKC0xKTtcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKTtcbiAgICAgIGxldCBidG5TYXZlID0gdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNidG4tc2F2ZVwiKTtcbiAgICAgIGJ0blNhdmUuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XG4gICAgICBsZXQgYnRuUmVkID0gdGhpcztcbiAgICAgIGJ0blJlZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgIGJ0blNhdmUub25jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFpbnB1dC52YWx1ZSkge1xuICAgICAgICAgIGlucHV0LnZhbHVlID0gbGFiZWwuaW5uZXJUZXh0O1xuICAgICAgICB9XG4gICAgICAgIGxhYmVsLmlubmVyVGV4dCA9IGlucHV0LnZhbHVlO1xuICAgICAgICBsYWJlbC5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjsgXG4gICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJjaGVja2JveFwiKTtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImVkaXQtaW5wdXRcIik7ICAgICAgICBcbiAgICAgICAgYnRuU2F2ZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIGJ0blJlZC5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcbiAgICAgICAgY2hhbmdlSXRlbShhcnJJdGVtcywgTnVtYmVyKHRoaXNJbnB1dE51bWJlcikgLSAxLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwidG9kb1wiLCBKU09OLnN0cmluZ2lmeShhcnJJdGVtcykpO1xuICAgICAgfVxuICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInRleHRcIik7XG4gICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKFwiZWRpdC1pbnB1dFwiKTtcbiAgICAgIGxhYmVsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjsgICAgICAgIFxuICAgICAgXG5cbiAgICAgIGZ1bmN0aW9uIGNoYW5nZUl0ZW0oYXJyOiBBcnJheTxJdGVtcD4sIG51bWJlcjogbnVtYmVyLCBzdHI6IFN0cmluZykge1xuICAgICAgICByZXR1cm4gYXJyW251bWJlcl0udG9kbyA9IHN0cjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8g0JjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8g0L/RgNC+0LLQtdGA0LrQuCDRgdC+0YHRgtC+0Y/QvdC40Y8g0LDQudGC0LXQvNCwXG4gIGZ1bmN0aW9uIGNoZWNrQ29uZGl0aW9uKCkge1xuICAgIGxldCBpdGVtc0luTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJsaS5pdGVtID4gaW5wdXRbdHlwZT0nY2hlY2tib3gnXVwiKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXNJbkxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgIChpdGVtc0luTGlzdFtpXSBhcyBIVE1MSW5wdXRFbGVtZW50KS5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgaW5wdXQgPSB0aGlzO1xuICAgICAgICBsZXQgdGhpc0lucHV0TnVtYmVyID0gaW5wdXQuaWQuc2xpY2UoLTEpO1xuXG4gICAgICAgIGlmICgoaW5wdXQgYXMgSFRNTElucHV0RWxlbWVudCkudHlwZSA9PT0gXCJ0ZXh0XCIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcItGN0YLQviDRgtC10LrRgdGC0L7QstC+0LUg0L/QvtC70LVcIik7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlucHV0Lmhhc0F0dHJpYnV0ZShcImNoZWNrZWRcIikpIHtcbiAgICAgICAgICBpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoXCJjaGVja2VkXCIpO1xuICAgICAgICAgIGNoYW5nZUl0ZW1DaGVjayhhcnJJdGVtcywgTnVtYmVyKHRoaXNJbnB1dE51bWJlcikgLSAxLCBmYWxzZSk7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ0b2RvXCIsIEpTT04uc3RyaW5naWZ5KGFyckl0ZW1zKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKFwiY2hlY2tlZFwiLCBcImNoZWNrZWRcIik7XG4gICAgICAgICAgY2hhbmdlSXRlbUNoZWNrKGFyckl0ZW1zLCBOdW1iZXIodGhpc0lucHV0TnVtYmVyKSAtIDEsIHRydWUpO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwidG9kb1wiLCBKU09OLnN0cmluZ2lmeShhcnJJdGVtcykpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNoYW5nZUl0ZW1DaGVjayhhcnI6IEFycmF5PEl0ZW1wPiwgbnVtYmVyOiBudW1iZXIsIGJvb2w6IEJvb2xlYW4pIHtcbiAgICAgICAgYXJyW251bWJlcl0uY2hlY2sgPSBib29sO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDQutC90L7Qv9C60Lgg0L7Rh9C40YHRgtC60Lgg0YHQv9C40YHQutCwINC40LcgTG9jYWxTdG9yYWdlXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWNsZWFyXCIpLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XG4gICAgb2wuaW5uZXJIVE1MID0gXCJcIjtcbiAgICBpdGVtQ291bnQgPSAwO1xuICAgIGFyckl0ZW1zID0gW107XG4gIH1cblxufSJdfQ=="}